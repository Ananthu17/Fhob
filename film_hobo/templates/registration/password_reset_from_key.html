{% extends "base.html" %}

{% load i18n %}


{% block content %}
<div class="wrapper flex-grow-1">
    <!-- {% block head_title %}{% trans "Change Password" %}{% endblock %} -->
    <div class="container mt-3 mb-3">
        <h1>{% if token_fail %}{% trans "Bad Token" %}{% else %}{% endif %}</h1>
        <div class="signup-form signup-section signup-border">
        <!-- Nav pills -->

        {% if token_fail %}
            {% url 'account_reset_password' as passwd_reset_url %}
            <p>{% blocktrans %}The password reset link was invalid, possibly because it has already been used.  Please request a <a href="{{ passwd_reset_url }}">new password reset</a>.{% endblocktrans %}</p>
        {% else %}
            {% if form %}
                <form method="POST" action="{{ action_url }}">
                    {% csrf_token %}
                    <ul class="nav nav-pills nav-justified" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link active" data-toggle="pill" href="{% url 'hobo_user:user_login' %}">Change Password</a>
                        </li>
                    </ul>
                    <hr class="m-0 signup-border-hr">
                    <!-- Tab panes -->
                    <div class="tab-content">
                        <div id="membership" class="container tab-pane active">
                            <div class="signup-form mt-2 mb-2 ">

                                <div class="row mt-4">
                                    <div class="col-2">
                                        <label class="form-title">New Password</label>
                                    </div>
                                    <div class="col-8">
                                        <input type="password" name="{{ form.new_password1.name }}" id="{{ form.new_password1.id_for_label }}" class="inp-line" placeholder="New Password" />
                                        {% if 'new_password1' in response %}
                                            {% for err in response.new_password1  %}
                                            <p style="color: red">{{err}}</p>
                                            {% endfor %}
                                        {% endif %}
                                    </div>
                                </div>
                                <div class="row mt-4 mb-4">
                                    <div class="col-2">
                                        <label class="form-title">Confirm Password</label>
                                    </div>
                                    <div class="col-8 ">
                                        <input type="password" name="{{ form.new_password2.name }}" id="{{ form.new_password2.id_for_label }}" class="inp-line" placeholder="Confirm Password" />
                                        {% if 'new_password2' in response %}
                                            {% for err in response.new_password2  %}
                                            <p style="color: red">{{err}}</p>
                                            {% endfor %}
                                        {% endif %}
                                    </div>
                                </div>
                                <input type = "hidden" name="uid" value = "{{request.GET.uid}}" />
                                <input type = "hidden" name="token" value = "{{request.GET.token}}" />
                                <input type = "hidden" name="email" value = "{{request.GET.email}}" />
                                <div class="d-flex justify-content-center align-items-center  mt-4 mb-4">
                                    <button type="submit" name="action" value="{% trans 'change password' %}" class="btn btn-login">Submit</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="d-flex justify-content-center align-items-center mt-3 signup-footer">
                        <ul class="list-inline m-0">
                        </ul>
                    </div>
                </form>
            {% else %}
                <p>{% trans 'Your password is now changed.' %}</p>
            {% endif %}
        {% endif %}
        </div>
    </div>
</div>
{% endblock %}
